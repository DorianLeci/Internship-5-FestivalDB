SELECT *
FROM workshop w
JOIN festival f ON f.festival_id = w.festival_id
WHERE LOWER(w.difficulty::text) = LOWER('NAPREDNA')
  AND (EXTRACT(YEAR FROM f.start_date) = 2025 OR EXTRACT(YEAR FROM f.end_date) = 2025)
ORDER BY current_enrolled DESC
LIMIT 10;

SELECT pe.name AS performer_name,f.name AS festival_name,s.name AS stage_name,lower(p.performance_period) AS performance_start
FROM performance p
JOIN festival_performer fp ON fp.festival_performer_id=p.festival_performer_id
JOIN performer pe ON pe.performer_id=fp.performer_id
JOIN stage s ON s.stage_id=p.stage_id
JOIN festival f ON f.festival_id=s.festival_id
WHERE p.expected_visitors>10000
LIMIT 100;

SELECT *FROM festival
WHERE (EXTRACT(YEAR FROM start_date) = 2025 OR EXTRACT(YEAR FROM end_date) = 2025)
LIMIT 100;

SELECT * FROM workshop
WHERE LOWER(difficulty::text)=LOWER('NAPREDNA')
ORDER BY current_enrolled DESC
LIMIT 10;

SELECT *FROM workshop
WHERE duration>=INTERVAL '4 hours'
ORDER BY duration DESC
LIMIT 100;

SELECT *FROM workshop
WHERE prior_knowledge_required=true
ORDER BY current_enrolled DESC
LIMIT 100;

SELECT 
	mentor_id,
	COALESCE(m.performer_id,m.staff_id) AS person_id,
	COALESCE(s.name,p.name) AS name,
	COALESCE(m.birth_date,s.birth_date) AS birth_date,
	m.expertise_area,m.years_of_experience
FROM mentor m
LEFT JOIN staff s ON m.staff_id=s.staff_id
LEFT JOIN performer p ON m.performer_id=p.performer_id
WHERE m.years_of_experience>10;







